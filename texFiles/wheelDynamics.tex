\documentclass[letterpaper, 10pt, conference]{ieeeconf}
%\documentclass[10pt,english,a4paper]{IEEEtran}
\IEEEoverridecommandlockouts
\overrideIEEEmargins

%\usepackage[a4paper, total={14cm, 25cm}]{geometry}
\usepackage{blindtext}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage{graphicx}
\usepackage[pdfencoding=auto]{hyperref}
%\usepackage{natbib}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{comment}
\usepackage{soul}
\usepackage{pdfpages}
%\usepackage[pdftex]{graphicx}
\usepackage{subfigure}
\pdfminorversion=4


\sethlcolor{green}

\input{abbr.tex}

\def\ankle{\text{ankle}}
\newcommand{\TODO}[1]{{\color{red} {\bf TODO:} {#1}}}
\newcommand{\SC}[1]{{\color{red} {\bf SC:} {#1}}}
\renewcommand{\SS}[1]{{\color{blue} {\bf SC:} {#1}}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}
%\renewcommand\IEEEkeywordsname{Keywords}

\def\pcmd{p^{cmd}}
\def\vcmd{v^{cmd}}

\title{\Large \bf
	Wheel Kinematics and Dynamics}

\author{Saeid Samadi, and Abderrahmane Kheddar
	\thanks{Authors are with Montpellier Laboratory of Informatics,
		Robotics and Microelectronics (LIRMM), CNRS-University of Montpellier, France.
		Corresponding author: {\tt\footnotesize saeid.samadi@lirmm.fr}}
}

\begin{document}

\maketitle
\thispagestyle{empty}
\pagestyle{empty}

\begin{abstract}
	This study deals with the kinematic and dynamic model of wheels. Wheels are part of robot model and this modeling has a significant effect in the performance of the robot...
\end{abstract}

\begin{keywords}
	Wheeled Robot Model, Dynamics, Kinematics
\end{keywords}

	
%%% XXX To be uncommented on "ieeeConf" document class
%\begin{keywords}
%Chebyshev center
%\end{keywords}
\begin{comment}

\begin{table}[h]
\renewcommand{\arraystretch}{1.5}
\caption{Table of Symbols}
\label{table_example}
\centering
\begin{tabular}{p{0.09\textwidth}|p{0.09\textwidth}||p{0.09\textwidth}|p{0.09\textwidth}}
%\begin{tabular*}{0.4\textwidth}{l | r || l | r}
\hline
\bfseries \centering First & \bfseries Next & me & you \\
\hline\hline
1.0 & 2.0\\
\hline
\end{tabular}
\end{table}
\end{comment}

\section{Introduction} \label{Sec_Introduction}

We characterize the robot or vehicle wheels into:
\begin{itemize}
	\item Driving wheel
	\item Push-pull wheel
\end{itemize}

The driving wheel has a torque input $\tau_{in}$ at the center of mass which is translated from the driving shaft. On the other hand, a linear force is applying to the CoM of a push/pull wheel. The Normal force $N$ is same in the both wheels acting on the driving/push-pull contact points with the ground $Q_{d/p}$. On the other hand, the friction forces $f_{fr}$ on these two types has different directions and cause contrary effects.

\begin{figure}[!h] 
	\subfigure[]{
		\includegraphics[height=0.25\columnwidth]{figs/PW.pdf}
		\label{PW}
	} 
	\subfigure[]{
		\includegraphics[height=0.25\columnwidth]{figs/DW.pdf} \label{DW}
	} 
	\caption{Free-body diagram of push-pull (a) and driving (b) wheels}
	
	\label{DPW}
\end{figure}

Note that the friction force on the driving wheel, is pointing to the $(+x)$ and for the push/pull wheel, the direction is $(-x)$. For the driving wheel, $f_{fr}$ causes forward movement and $tau_{in}$ results in rolling. Whereas for the push/pull wheel, moving forward and rolling are results of $P_{in}$ and $f_{fr}$ respectively.

The effect of the torques and forces on the motion of a wheel can also be categorized into:
\begin{itemize}
\item Driving Component
\item Rolling Component
\item Normal Component
\end{itemize}

The forces/torques which result in the forward/backward driving of the wheel are among \emph{driving components}. For a driving wheel, friction force and for a push/pull wheel, the input force are driving components. On the other hand, forces/torques which result in rolling motion of the wheel are categorized as rolling components; such as input torque and friction force for driving and push-pull wheels, respectively.

The normal component is also including the forces which are normal to the direction of the linear motion and has no effect on driving and rolling motions of the wheel.
\section{Driving Wheel On the Flat Surface} \label{DrivingWheel}

Assume that the wheel is driven by driving torque $\tau_{in}$ without any active pulling forces $P_{in}$ as shown in Fig.~\ref{DW}. This type of wheel is noted as driving wheel in the rest of the paper. We need to identify a valid condition for slippage. 

\subsection{Slippage Criteria for a Driving Wheel} \label{SlipCri-DW}

For a pure driving wheel, the decisive variable is the amount of $\tau_{in}$. If $\tau_{in}$ is less than a maximum value of $\tau_{in}^{max}$, then the motion is without slippage. Otherwise, wheel's motion is a combination of rolling and slipping. For a driving wheel, we have the following relations:
\begin{align}
F_{fr} &= ma_c \label{f_fr}\\
\tau_{in} - RF_{fr} &= I_c \alpha_c \label{moment_eq}
\end{align}

Assuming no slippage condition and considering the maximum possible static force before slippage, we have:
\begin{align}
F_{fr}^{max} &= \mu_{s} N \label{f_fr_max} \\
\alpha_c &= \frac{a_c}{R} \label{alpha_noSlip}
\end{align}
where $\mu_s$ and $R$ are the static friction coefficient and wheel radius. Subsequently, we note he dynamic friction coefficient as $\mu_d$. from~\eqref{f_fr}~and~\eqref{f_fr_max}, we have:
\begin{align}
a_c^{max} = \frac{F_{fr}^{max}}{m} = \mu_s g
\end{align}
Therefore the maximum input torque to the wheel before starting the slippage is calculated from~\eqref{moment_eq}:
\begin{align}
\tau_{in}^{max} = I_c \frac{a_c^{max}}{R} + R F_{fr}^{max} \label{tau_in_max}
\end{align}
So, the slippage condition for a driving wheel on the flat surface is:
\begin{align}
if \begin{cases}
\tau_{in} \leqslant \tau_{in}^{max} &\Rightarrow \ \text{No Slip} \\
\text{Otherwise} &\Rightarrow \ \text{Slip}
\end{cases} \label{slipCondition}
\end{align}
In the following two subsections, we are analyzing the wheel dynamics in absence and presence of the slippage.
\subsection{Driving Wheel Without Slippage} \label{DWNoSlip}
As described in~\eqref{slipCondition}, the condition for no slippage is $\tau_{in} \leqslant \tau_{in}^{max}$. Using~\eqref{f_fr},\eqref{moment_eq}~and~\eqref{alpha_noSlip} we have:
\begin{align*}
\tau_{in} - Rma_c &= I_c \frac{a_c}{R} \\
\Rightarrow \tau_{in} &= (\frac{I_c}{R} + Rm)a_c
\end{align*}
so then:
\begin{align}
a_c = \frac{\tau_{in}}{\frac{I_c}{R} + Rm}
\end{align}
So $\alpha_c = \frac{a_c}{R}$ is calculated accordingly and the other components at time $t$ are:
\begin{align}
v_{c,t} &= a_{c,t}dt + v_{c,t-dt} \label{linearVel}\\
\omega_{c,t} &= \alpha_{c,t}dt + \omega_{c,t-dt} \label{angularVel}\\
F_{fr} &= ma_c
\end{align}
where $dt$ denotes the duration of each time step. Note that the value of the $F_{fr}$ is not equal to $\mu_sN$ except when it reaches to the slipping limit.

In order to calculate the velocity of each point on the wheel as a rigid body with respect to the inertial frame shown in Fig.~\ref{DPW}, we use the relative velocity equation. The relative velocity of a point such as $K$ with respect to the inertial frame is $v_{K/O}$ and for simplicity, it is noted as $v_K$.
\begin{align}
v_Q = v_{Q/c} + v_c
\end{align}
At a specific time, the point $Q$ is a selected as the contact point of the wheel with the ground and fixed to the wheel. By considering no slippage condition, $v_c = R\omega$ and $v_{Q/c} = -R\omega$. So then the velocity of point $Q$ with respect to the inertial frame is becoming $0$.

\begin{figure}[!h] 
	\centering
	\includegraphics[width=0.85\columnwidth]{figs/Vel.pdf}
	\caption{Kinematic schematic of a driving wheel}
	\label{velFig}
\end{figure}


The term $v_t$ indicates the tangantial velocity of and arbitrary point $A$ on the wheel. If case of $R\omega \neq v_c$, slip occurs. This slippage can be a \emph{forward or backward slippage}. For better imagination of the expression Forward slippage, we can consider a wheel without rolling (or full-brake) and pushing forward. What happens is a pure slippage without any rotation and called Forward slippage. On the other hand, if the wheel just has the rotation in place (without linear velocity), then Backward slippage occurs. Fig.~\ref{SlipDiagram} demonstrates three conditions by point tracking on the wheel over the time. These three conditions are no-slip, backward-slippage and forward-slippage modes.

\begin{figure}[!h] 
	\subfigure[]{
		\includegraphics[width=0.95\columnwidth]{figs/NoSlip.pdf}
		\label{NoSlip}
	} 
	\subfigure[]{
		\includegraphics[width=0.95\columnwidth]{figs/FwSlip.pdf} \label{FwSlip}
	} 
	\subfigure[]{
		\includegraphics[width=0.95\columnwidth]{figs/BwSlip.pdf} \label{BwSlip}
	} 
	\caption{Position tracking of point $A$ on the wheel. (a) shows the point tracking in no-slip condition. In this case, wheel has no slippage while rotation. (b) shows the backward-slippage. This can happen for a push-pull wheel where the pulling force causes slippage on the ground. (c) shows the forward slippage which be the case in driving wheels in case of high input torque.}
	
	\label{SlipDiagram}
\end{figure}


\subsection{Driving Wheel With Slippage} \label{DWSlip}
For a driving wheel, $R\omega > v_c$ is possible. This can happen if $\tau_{in} > \tau_{in}^{max}$. In that case, the contact point is slightly sliding on the ground along with the rotary motion of the wheel. So the friction force becomes $F_{fr} = \mu_d N$:
\begin{align}
F_{fr} &= \mu_d mg = ma_c \\
\Rightarrow a_c &= \mu_dg \\
\tau_{in} - Rma_c &= I_c \alpha_c \\
\Rightarrow \alpha_c &= \frac{\tau_{in} - Rma_c}{I_c}
\end{align}
Then the linear and angular velocities can be computed same as~\eqref{linearVel}~and~\eqref{angularVel}.

\section{Push-pull Wheel On the Flat Surface}
A push-pull wheel is driven by an exogenous pulling or pushing force $P_{in}$. Therefore, this force is the driving component and the friction force which has the opposite direction, will be the rolling component. In this section, we study the pure push/pull wheel without applying any exogenous torque inputs.

\subsection{Slippage Criteria for a Push-Pull Wheel} \label{SlipCri-PW}

Schematic of a push-pull wheel is shown in Fig.~\ref{PW}.
The governing Newton-Euler equations for the rigid body are:
\begin{align}
P_{in} - F_{fr} &= ma_c \label{PW_force} \\
RF_{fr} &= I_c \alpha_c \label{PW_torque}
\end{align}
The maximum sliding force before slippage is $F_{fr} = \mu_sN$. So,according to the non-slip condition $\alpha_c = \frac{a_c}{R}$,~\eqref{PW_torque} becomes:
\begin{align}
R\mu_sN &= I_c \frac{a_c^{max}}{R} \\
\Rightarrow a_c^{max} &= R^2 \mu_s \frac{N}{I_c} \label{PW_acMax}
\end{align}
Now, by combining~\eqref{PW_acMax}~and~\eqref{PW_force}, one can calculate the maximum exogenous input force that can be applied before slipping occurs:
\begin{align}
P_{in}^{max} &= ma_c^{max} + \mu_sN \\
& = \mu_sN (m\frac{R^2}{I_c} + 1)
\end{align}
So, the slippage condition for a push-pull wheel on the flat surface is:
\begin{align}
if \begin{cases}
P_{in} \leqslant P_{in}^{max} &\Rightarrow \ \text{No Slip} \\
\text{Otherwise} &\Rightarrow \ \text{Slip}
\end{cases} \label{PW_slipCondition}
\end{align}
\subsection{Push-Pull Wheel Without Slippage}

The governing equations for the push-pull wheel are introduced by~\eqref{PW_force}~and~\eqref{PW_torque}. By considering the non-slip condition $\alpha_c = \frac{a_c}{R}$, we have:
\begin{align}
P_{in} - F_{fr} &= ma_c = \frac{W}{g} a_c \\
F_{fr} &= \frac{I_c}{R^2} a_c \\
\Rightarrow P_{in} &= (\frac{W}{g} + \frac{I_c}{R^2})a_c
\end{align}
where $W$ is the weight of the wheel. So then the linear acceleration of the CoM of the wheel in no-slip condition is:
\begin{align}
a_c &= \frac{P_{in}}{\frac{W}{g} + \frac{I_c}{R^2}} \\
\alpha_c &= \frac{a_c}{R} \\
F_{fr} &= \frac{I_c}{R^2} a_c
\end{align}
Note that $F_{fr} \neq \mu_{s}N$ unless it reaches to the boundary of starting slippage.
\subsection{Push-Pull Wheel With Slippage}


\section{Parametric Computation of the Point Velocities on the Wheel}
In previous sections, velocity of the points on the wheel is mentioned. Especially when these points touch the ground. Fig.~\ref{SlipDiagram} shows the position tracking of an arbitrary point. In this section, we aim for calculating the velocity of an arbitrary point at a specific time.

Assume that the CoM of the wheel has a linear velocity of $V_x$. On the other hand, the tangantial velocity of the arbitrary point is noted as $V_T$. Fig.~\ref{velocityCalc} shows the schematic of the wheel and point velocity vectors.
\begin{figure}[!h] 
	\centering
	\includegraphics[width=0.85\columnwidth]{figs/velocityCalc.pdf}
	\caption{Velocity analysis of a rotating wheel}
	\label{velocityCalc}
\end{figure}

\begin{align}
\vec{V}_{tot} &= V_x \hat{x} + V_T \sin(\theta)\hat{x} - V_T \cos(\theta)\hat{y} \\
\lvert \vec{V}_{tot} \rvert &= \sqrt{\vec{V}_{tot,x}^2 + \vec{V}_{tot,y}^2}
\end{align}

This formula is general and accounts for every single point chosen on the perimeter of the circle.
\section{Generic Scenarios}

A generic scenario includes external forces applied on the wheel on non-flat surfaces. As an example to step into the general scenarios, we first study a driving wheel on the slope.
We consider a driving wheel on the slope. So, the wheel is under an input torque $\tau_{in}$ which is driving the wheel. First, we divide the scenarios into the following terms:
\begin{itemize}
	\item Descending wheel
	\item Ascending wheel
\end{itemize}

\subsection{Descending Driving Wheel}
The wheel has an input torque which helps for going down the slope. The Fig.~\ref{slopeDown} shows schematic of this wheel.

\begin{figure}[!h] 
	\centering
	\includegraphics[width=0.85\columnwidth]{figs/slopeDown.pdf}
	\caption{Descending driving wheel}
	\label{slopeDown}
\end{figure}

We consider the sum of all forces applied on the wheel, other than the fricion force, as an external force. So, by considering no exogenous forces, we still have the effect of the weight as $mg\sin(\theta)$. Therefore, $F_{ext} = mg\sin(\theta)$. So, the governing Newton-Euler equations are:
\begin{align}
F_{fr} + F_{ext} &= ma_c \label{DWSlope_force} \\
\tau_{in} - RF_{fr} &= I_c \alpha_c \label{DWSlope_torque}
\end{align}
So we can re-write the \eqref{DWSlope_force} as $F_{fr} = ma_c - F_{ext}$ and take the same procedure as Section~\ref{SlipCri-DW} for deriving the slip condition:
\begin{align}
a_c^{max} &= \frac{F_{fr}^{max} + F_{ext}}{m} \\
\alpha_c^{max} &= \frac{a_c^{max}}{R}
\end{align}
where $F_{fr}^{max}$ is same as~\eqref{f_fr_max}. So, $\tau_{in}^{max}$ can be computed by \eqref{tau_in_max}.
\subsubsection{Descending Without Slippage}
By taking same computation procedure of Section~\ref{DWNoSlip}, we have
\begin{align}
a_c = \frac{\tau_{in} + R F_{ext}}{\frac{I_c}{R} + Rm}
\end{align}

\subsubsection{Descending With Slippage}
If slippage occurs, we use Section~\ref{DWSlip} for computations which results in
\begin{align}
a_c &= \mu_dg + \frac{F_{ext}}{m} \\
\alpha_c &= \frac{\tau_{in} - \mu_d N R}{I_c}
\end{align}

Note that for descending of the wheel, $\tau_{in} \geqslant 0$ in the direction shown in the figure is enough. Because due to the gravity, the wheel has tendency to go down the slop even without the input torque.
\subsection{Ascending Driving Wheel}
In contrast to the previous section, the input torque is applied in order to climb. The Fig.~\ref{slopeUp} shows the schematic of this condition.

\begin{figure}[!h] 
	\centering
	\includegraphics[width=0.85\columnwidth]{figs/slopeUp.pdf}
	\caption{Ascending driving wheel}
	\label{slopeUp}
\end{figure}


Same as previous section, we consider no exogenous external forces applied to the wheel. So, $F_{ext} = mg\sin(\theta)$ and the Newton-Euler equation of the rigid body is:

\begin{align}
-F_{fr} + F_{ext} &= ma_c \label{DWSlope_force_ac} \\
-\tau_{in} + RF_{fr} &= I_c \alpha_c \label{DWSlope_torque_ac}
\end{align}
and the maximum linear and rotational accelerations are:

\begin{align}
a_c^{max} &= \frac{-F_{fr}^{max} + F_{ext}}{m} \\
\alpha_c^{max} &= \frac{a_c^{max}}{R}
\end{align}

Then we achieve the slippage criteria by computing $F_{fr}^{max}$ and $\tau_{in}^{max}$ as mentioned in~\eqref{f_fr_max}~and~\eqref{tau_in_max}. On the other hand, we need to guarantee ascending of the wheel. For this purpose, we have to define a minimum input torque which should be applied to the wheel in order to have ascending motion. For a wheel on the slope, $a_c = 0$ and $\alpha_c = 0 $ are required (but not sufficient) conditions in order to be fixed in place and avoid descending. So, by considering these conditions, we have:
\begin{align}
F_{fr} &= F_{ext} \\
\tau_{in} &= RF_{fr}
\end{align}
Above equations are resulting in $\tau_{in} = RF_{ext}$. So, to guarantee the ascending motion of the wheel, we need to fulfill the following equation:
\begin{align}
\tau_{in} \geqslant R mg\sin(\theta)
\end{align}
This is in case of existence of no exogenous forces acting on the robot. By considering the exogenous forces $F_{exogenous}$, we can extend this criteria to
\begin{align}
\tau_{in} \geqslant R mg\sin(\theta) + F_{exogenous}
\end{align}
\subsubsection{Ascending Without Slippage}
Calculating the linear acceleration can provide the rotational acceleration by $\alpha_c = \frac{a_c}{R}$
\begin{align}
a_c = \frac{-\tau_{in} + R F_{ext}}{\frac{I_c}{R} + Rm}
\end{align}

\subsubsection{Ascending With Slippage}
In case of slippage, using the same calculations as Section~\ref{DWSlip} we have
\begin{align}
a_c &= -\mu_dg + \frac{F_{ext}}{m} \\
\alpha_c &= \frac{-\tau_{in} + \mu_d N R}{I_c}
\end{align}


\begin{comment}
Wheel kinematics and dynamics are widely studied. Considering the multi-directional slippages, due to numerous variables such as wheel inertia, material and contact forces within these models, are challenging.  In sections~\ref{Sec_Kinematics}~and~\ref{Sec_Dynamics}, we describe the proposed method in~\cite{Seegmiller2014thesis}.
\section{Wheel Kinematics} \label{Sec_Kinematics}

The case study for~\cite{Seegmiller2014thesis} is a car model with six wheels as shown in Fig.~\eqref{rocky7}
\begin{figure}[!h] 
	\centering
	\subfigure[]{
		\includegraphics[width= 0.65\columnwidth]{figs/car.png}
		\label{Choreonoid}
	} 
	\subfigure[]{
		\includegraphics[width= 0.65\columnwidth]{figs/rocky7.jpg} \label{pymanoid}
	} 
	\caption{(a) Model and frame diagram of the car. This model contains six wheels and the frames for the body, shafts, center of wheels and also the contact frames are defined.
		(b) Rocky 7 test bed \protect\footnotemark}
	\label{rocky7}
\end{figure}
\footnotetext{Rocky 7 is research test bed for navigation and rover-based sampling. It is approximately $60 \times 40 \times 25 \ cm$ in size and $16 \ kg$ in mass. On Rocky 7, only the front wheels are steerable, while the back bogie wheels are close together and have no steering. This mobility design concept was implemented to test the maneuverability of a system with fewer actuators.}


\section{Wheel Dynamics} \label{Sec_Dynamics}

\end{comment}
%\bibliographystyle{ieeetr}
%\bibliography{refs}
\end{document}
